amends ".../engine/faction/main.pkl"

name = "Legion"

local faction_id = this.slug
local fac_defaults = new Mixin {
  faction = faction_id
}

talents {
  default {
    faction = faction_id
  }

  new {
    name = "Value in Death"
    description = "On death, Thralls heal nearby heroes (30/60hp) or increase attack speed of heroes and vehicles (+15% for 10sec)"
    column = 1 
    level = 1
  }

  new {
    name = "Reused Equipment"
    description = "Thralls refund 25% of their cost on death."
    column = 1 
    level = 2
  }

  new {
    name = "Performance Enhancers"
    description = "+20% movement speed and +10% weapon damage for infantry (excluding heroes)"
    column = 1 
    level = 3
  }

  new {
    name = "Hero Companions"
    description = "(UNFINISHED) Each hero gains a companion drone."
    column = 1 
    level = 4
  }

  new {
    local tbp = topbar[2]
    slug = tbp.slug.replaceLast("-topbar", "-talent")
    name = tbp.name.replaceLast(" (Topbar)", "(Talent)")
    description = "Unlocks The \(tbp.name) topbar power: \(tbp.description)"
    column = 1
    level = 5
    unlocks { tbp.slug }
  }

  new {
    name = "Wrath"
    description = "Killed units drop mines on death (1 per 3 supply lost)"
    column = 2 
    level = 1
  }

  new {
    name = "Armed Obelisks"
    description = "Obelisks have an additional weapon (10 DPS)"
    column = 2 
    level = 2
  }

  new {
    name = "War Experience"
    description = "Gain additional experience by destroying enemy units. (30% cost as XP)"
    column = 2 
    level = 3
  }

  new {
    name = "Power to Destroy"
    description = "Gain Topbar power by killing enemy structures and harvesters. (2.5% cost as power)"
    column = 2 
    level = 4
  }

  new {
    local tbp = topbar[3]
    slug = tbp.slug.replaceLast("-topbar", "-talent")
    name = tbp.name.replaceLast(" (Topbar)", "(Talent)")
    description = "Unlocks The \(tbp.name) topbar power: \(tbp.description)"
    column = 2 
    level = 5
    unlocks { tbp.slug }
  }
}

topbar {
  default { faction = faction_id }

  new {
    name = "Recall"
    topbar_type = "recall"
    description = "Recalls units to the nearest HQ or Outpost. First click to select units, click again where to recall."
    slot = 1
    cost = 5
    cooldown = 110
  }

  new {
    name = "Guardian Obelisk"
    topbar_type = "special"
    description = "Spawn various obelisks on the battlefield (See Legion Buildings)"
    cost = 15
    delay = 3.0
    slot = 2
  }

  new {
    name = "Ritual (Topbar)"
    topbar_type = "ultimate"
    description = "Start ritual on one of XP towers. When ritual finishes, an Emperor projection will spawn for 90s. Sacrifice thralls to make it more powerful. From Thrall remains you also gain some resources back."
    slot = 3
    cost = 50
    cooldown = 180
    unlocked_by { "airstrike-talent" }
  }

  new {
    name = "Spawn Monolith (Topbar)"
    topbar_type = "ultimate"
    description = "Spawn a monolith with a powerful weapon. If a nearby thrall dies, strike a random enemy target with energy. Lasts 45 seconds."
    cost = 50
    slot = 4
    cooldown = 120
    unlocked_by { "spawn-monolith-talent" }
  }
}


buildings {
  // import("buildings/x.pkl") |> fac_defaults
}

units {
  import ("units/T3/terror_tank.pkl") |> fac_defaults
  import ("units/T3/dreadnought.pkl") |> fac_defaults
}

heroes {
  // import("heroes/x.pkl") |> fac_defaults
}

cross_faction_heroes { }
