amends ".../engine/unit.pkl"
import ".../engine/turret.pkl" as Turret
import ".../engine/types.pkl" as $t
import "dreadnought.pkl" as me

name = "Dreadnought"

tags { "massive" }

hexite_cost = 150 
flux_cost = 250
supply = 20
hp = 1000
speed = 500
armor_type = "heavy"
stun_resist = 75
build_time = 60
domain = "air"

constructing_version {
  name = "Terror Tank (Constructing)"
  build_time = 60
  hp = 1000
}

local main_weapon: String = "\(me.name)'s \(me.attacks[0].name)"

attacks {
  ["Main Beam Weapon"] {
    damage = 5
    cooldown = 0.5
    range = 1400
    bonus_percent = 200
    bonus_vs_tags { "armor:heavy" }
  }
}

spells {
  ["Bombardment Run"] {
    volleys = 3
    cooldown = 1
    damage = 89
  }
  ["Teleport"] {
    name = "Teleport"
    teleport = 4000
    cooldown = 0
    unlocked_by { me.turrets["Command Module"].slug }
  }
}

passives {
  ["Sensor"] {
    name = "Sensor"
    provides_detection = 4000
    unlocked_by { me.turrets["Command Module"].slug }
  }
}


has_turret_type = "turret"
max_turrets = 4
turrets {
  default {
    flux_cost = 150
    build_time = 25
    hp = 225
    armor_type = "heavy"
  }
  ["Bomb Bay"] {
    description = "Each \(name) adds 3 bombs to \(me.name)'s \(me.spells["Bombardment Run"].name) spell. Total bomb damage 267/534/801/1068/1335 for 0/1/2/3/4."
  }
  ["Command Module"] { 
    description = "Unlocks \(me.name)'s \(me.spells["Teleport"].name) spell and \(me.passives["Sensor"].name) passive. Both abilities have a base 4000 range, and each \(name) adds +1000 range. 5000/6000/7000/800 for 1/2/3/4."
    unlocks { me.spells["Teleport"].slug; me.passives["Sensor"].slug }
  }
  ["Beam Module"] {
    description = "Each \(name) adds +30% damage to \(me.name)'s \(me.attacks["Main Beam Weapon"].name) attack. Main beam dmg: 5/7/8/10/11 for 0/1/2/3/4."
  }
  ["Anti-Air Turret"] {
    description = "Attacks ground and air but does 3x dmg to air"
    attacks {
      ["Turret Attack"] {
        damage = 9
        volleys = 2
        cooldown = 2
        targets { "air"; "ground" }
        range = 2000
      }
    }
  }
}
