/// gamepiece is the superclass for units, buildings, etc, and represents an on-screen, in-game object. 
abstract module gamepiece 
extends "data.pkl"
import "ability/attack.pkl" as Attack
import "ability/heal.pkl" as Heal
import "ability/spell.pkl" as Spell
import "ability/passive.pkl" as Passive

import "types.pkl" as $t

/// short description of the purpose of this, to be used in summaries in UI. Many of these won't be in game. 
/// examples: "fast melee attacker" for a unit, "vision buff" for an upgrade, etc
role: String = "Submit your suggestion on ZSGG Discord!"

/// hexite cost to build. 0 for gamepieces that are cast
hexite_cost: UInt? 
flux_cost: UInt?
build_count: UInt? = 1
cooldown: UInt?
energy_cost: UInt?
topbar_cost: UInt?
build_time: UInt?
rebuildable: Boolean?
rebuild_time: UInt?
domain: $t.DomainType = "ground"

hotkey: $t.HotKey?
tier: $t.Tier

gathers_flux: Float?
gathers_rich_flux: Float?

gathers_hexite: Float?
gathers_empty_hexite: Float?

supply: UInt?
hp: UInt?
vision: UInt?
speed: UInt?
shields: UInt?
abes_energy: UInt?
energy: UInt?
armor: UInt?

armor_type: $t.ArmorType = "none"
stun_resist: UInt?

provides_flux: UInt?
provides_hex: UInt?
provides_supply: UInt?
provides_biomass: UInt?
provides_upgrades_for: Listing<String>(isDistinct)?

transforms_from: Listing<String>(isDistinct)?
transforms_into: Listing<String>(isDistinct)?

local df = this.faction
local ds = this.slug

attacks: Listing<Attack> = new Listing<Attack> {
  default { faction = df; ability_of = ds }
}

heals: Listing<Heal> = new Listing<Heal> {
  default { faction = df; ability_of = ds }
}

spells: Listing<Spell> = new Listing<Spell> {
  default { faction = df; ability_of = ds }
}
passives: Listing<Passive> = new Listing<Passive> {
  default { faction = df; ability_of = ds }
}
