module unit 
extends "gamepiece.pkl"

import "infuse.pkl" as $i

fixed type = "unit"
fixed subtype = unit_type

tag { "unit" }
hidden unit_type: "worker" | "harvester" | "army" | "hero"

vision = 1800

massive: Boolean = false

local tl = tags.toList()

infusable: Boolean = unit_type != "worker"  && !massive

infuse_rule: $i.InfuseRule? = 
  if (!infusable) 
    null 
  else
    $i.standard_infuse_rule

infuse_cost: UInt? = 
  if (!infusable) 
    null 
  else
    let (h = hexite_cost ?? 0)
    let (f = flux_cost ?? 0)
    ((h + f) / 10).floor.toInt() + 1
