module infuse

class StatMultiplier { fixed type="mult"; num: Number }
class StatReplacer { fixed type="replace"; num: Number }
class StatAdder { fixed type = "add"; num: Number }

typealias InfuseStat = StatMultiplier | StatReplacer | StatAdder

class TransformInfuseRule {
  fixed type = "transform"
  into: String
}

class BasicInfuseRule {
  fixed type = "basic"
  supply: InfuseStat?
  hp: InfuseStat?
  damage: InfuseStat?
  reload_time: InfuseStat?
  cooldown: InfuseStat?
}

fixed standard_infuse_rule = new BasicInfuseRule {
  supply = new StatMultiplier { num = 2.0 }
  hp = new StatMultiplier { num = 2.0 }
  reload_time = new StatMultiplier  { num = 0.5 }
  cooldown = new StatMultiplier  { num = 0.5 }
}

fixed damage_infuse_rule = new BasicInfuseRule {
  supply = new StatMultiplier  { num = 2.0 }
  hp = new StatMultiplier { num = 2.0 }
  damage = new StatMultiplier { num = 2.0 }
  cooldown = new StatMultiplier { num = 0.5 }
}

typealias InfuseRule = TransformInfuseRule | BasicInfuseRule

function transform (n: String) = new TransformInfuseRule { into = n }
